const createModalDiscount = $("#create-modal-discount"), editModalDiscount = $("#edit-modal-discount"), deleteModalDiscount = $("#delete-modal-discount"); let idDiscount; !function (e, t) { "object" == typeof exports && "undefined" != typeof module ? t(exports) : "function" == typeof define && define.amd ? define(["exports"], t) : t((e = "undefined" != typeof globalThis ? globalThis : e || self).vn = {}) }(this, function (e) { "use strict"; var t = "undefined" != typeof window && void 0 !== window.flatpickr ? window.flatpickr : { l10ns: {} }, i = { weekdays: { shorthand: ["CN", "T2", "T3", "T4", "T5", "T6", "T7"], longhand: ["Chủ nhật", "Thứ hai", "Thứ ba", "Thứ tư", "Thứ năm", "Thứ sáu", "Thứ bảy"] }, months: { shorthand: ["01", "02", "03", "04", "55", "06", "07", "08", "09", "10", "11", "12"], longhand: ["Tháng một", "Tháng hai", "Tháng ba", "Tháng tư", "Tháng năm", "Tháng sáu", "Tháng bảy", "Tháng tám", "Tháng chín", "Tháng mười", "Tháng mười một", "Tháng mười hai"] }, firstDayOfWeek: 1, rangeSeparator: " đến " }; t.l10ns.vn = i; var n = t.l10ns; e.Vietnamese = i, e.default = n, Object.defineProperty(e, "__esModule", { value: !0 }) }), $(".pick-date-date").flatpickr({ locale: "vn", enableTime: !0, dateFormat: "m-d-Y H:i", time_24hr: !0, minDate: "today", defaultHour: (new Date).getHours(), defaultMinute: (new Date).getMinutes() }); const createModal = $("#create-modal"), editModal = $("#edit-modal"), deleteModal = $("#delete-modal"); let discoundID; $(".dimis-modal").click(function () { createModal.modal("hide"), editModal.modal("hide"), deleteModal.modal("hide") }), $("#create__open").click(function () { createModal.modal("show") }), $("#create__save").click(function () { const e = $("#create__input-price").val(), t = $("#create__input-code").val(), i = $("#create__input-quan").val(), n = $("#create__input-start").val(), o = $("#create__input-expired").val(); if ("" != e) if ("" != n) if ("" != o) $.ajax({ type: "POST", url: "/Discounts/Create", contentType: "application/json; charset=utf-8", data: JSON.stringify({ discountPrice: e, discountStart: n, discountEnd: o, discountCode: t, quantity: i }), dataType: "json", success: function (e) { if ("success" == e) { return Swal.mixin({ toast: !0, position: "top-end", showConfirmButton: !1, timer: 1e3, didOpen: e => { e.addEventListener("mouseenter", Swal.stopTimer), e.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "success", title: "Thêm thành công" }), setTimeout(function () { window.location.reload() }, 500), void createModalLogin.modal("hide") } }, error: function () { Swal.mixin({ toast: !0, position: "top-end", showConfirmButton: !1, timer: 1500, didOpen: e => { e.addEventListener("mouseenter", Swal.stopTimer), e.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "error", title: "Thêm thất bại" }) } }); else { Swal.mixin({ toast: !0, position: "top", showConfirmButton: !1, timer: 1500, didOpen: e => { e.addEventListener("mouseenter", Swal.stopTimer), e.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "warning", title: "Nhập ngày kết thúc" }) } else { Swal.mixin({ toast: !0, position: "top", showConfirmButton: !1, timer: 1500, didOpen: e => { e.addEventListener("mouseenter", Swal.stopTimer), e.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "warning", title: "Nhập ngày bắt đầu" }) } else { Swal.mixin({ toast: !0, position: "top", showConfirmButton: !1, timer: 1500, didOpen: e => { e.addEventListener("mouseenter", Swal.stopTimer), e.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "warning", title: "Nhập mức giảm" }) } }); var regex = /(\d)(?=(\d{3})+(?!\d))/g, editOpen = function (e, t, i, n, o, d) { editModal.find("#edit__input-price").val(t), editModal.find("#edit__input-code").val(i), editModal.find("#edit__input-quan").val(d), editModal.find("#edit__input-start").val(n), editModal.find("#edit__input-expired").val(o), editModal.modal("show"), discoundID = e }; $("#edit__save").click(function () { const e = $("#edit__input-price").val(), t = $("#edit__input-code").val(), i = $("#edit__input-quan").val(), n = $("#edit__input-start").val(), o = $("#edit__input-expired").val(); if ("" != e) if ("" != n) if ("" != o) $.ajax({ type: "POST", url: "/Discounts/Edit", contentType: "application/json; charset=utf-8", data: JSON.stringify({ id: discoundID, discountPrice: e, discountStart: n, discountEnd: o, discountCode: t, quantity: i }), dataType: "json", success: function (d) { if ("exist" != d) { Swal.mixin({ toast: !0, position: "top-end", showConfirmButton: !1, timer: 1e3, didOpen: e => { e.addEventListener("mouseenter", Swal.stopTimer), e.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "success", title: "Cập nhật thành công" }); var a = e; return a += "", $("#discount-price_" + discoundID).text(a.replace(regex, "$1.") + "₫"), $("#dis-name_" + discoundID).text("Giảm " + a.replace(regex, "$1.") + "₫ Từ " + n + " => " + o), $("#discount-code_" + discoundID).text(t), $("#discount-quan_" + discoundID).text(i), void editModal.modal("hide") } Swal.mixin({ toast: !0, position: "top", showConfirmButton: !1, timer: 1500, didOpen: e => { e.addEventListener("mouseenter", Swal.stopTimer), e.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "error", title: "Tên đã tồn tại" }) }, error: function () { Swal.mixin({ toast: !0, position: "top-end", showConfirmButton: !1, timer: 1500, didOpen: e => { e.addEventListener("mouseenter", Swal.stopTimer), e.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "error", title: "Chỉnh sửa thành công" }) } }); else { Swal.mixin({ toast: !0, position: "top", showConfirmButton: !1, timer: 1500, didOpen: e => { e.addEventListener("mouseenter", Swal.stopTimer), e.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "warning", title: "Nhập ngày kết thúc" }) } else { Swal.mixin({ toast: !0, position: "top", showConfirmButton: !1, timer: 1500, didOpen: e => { e.addEventListener("mouseenter", Swal.stopTimer), e.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "warning", title: "Nhập ngày bắt đầu" }) } else { Swal.mixin({ toast: !0, position: "top", showConfirmButton: !1, timer: 1500, didOpen: e => { e.addEventListener("mouseenter", Swal.stopTimer), e.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "warning", title: "Nhập mức giảm" }) } }); var deleteOpen = function (e, t) { deleteModal.find("#delete__name").text(t), deleteModal.modal("show"), discoundID = e }; $("#delete__submit").click(function () { $.ajax({ type: "POST", url: "/Discounts/Delete", contentType: "application/json; charset=utf-8", data: JSON.stringify({ id: discoundID }), dataType: "json", success: function (e) { if ("delete" == e) { return Swal.mixin({ toast: !0, position: "top-end", showConfirmButton: !1, timer: 1500, didOpen: e => { e.addEventListener("mouseenter", Swal.stopTimer), e.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "success", title: "Xóa thành công" }), deleteModal.modal("hide"), void $("#item_" + discoundID).remove() } }, error: function () { Swal.mixin({ toast: !0, position: "top", showConfirmButton: !1, timer: 1500, didOpen: e => { e.addEventListener("mouseenter", Swal.stopTimer), e.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "error", title: "Xóa thất bại" }) } }) });