const UpdateModal = $("#update-order-modal"), cancleModal = $("#cancle-modal"); let orderId, OrderStatus, statusName, att; $(".dimis-modal").click(function () { UpdateModal.modal("hide"), cancleModal.modal("hide") }); var onProcessOpen = function (t) { UpdateModal.find("#update__id").text(t), UpdateModal.find("#update__status").text("Đang xử lý"), UpdateModal.find("#icon").html('<i class="bi bi-cart-plus text-info" style="font-size:6rem"></i>'), UpdateModal.modal("show"), orderId = t, OrderStatus = "2", statusName = "Đang xử lý" }, CompletedOpen = function (t) { UpdateModal.find("#update__id").text(t), UpdateModal.find("#icon").html('<i class="bi bi-cart-check text-success" style="font-size:6rem"></i>'), UpdateModal.find("#update__status").text("Hoàn thành"), UpdateModal.modal("show"), orderId = t, OrderStatus = "3", statusName = "Hoàn thành" }; $("#update__submit").click(function () { $.ajax({ type: "POST", url: "/Orders/UpdateOrder", contentType: "application/json; charset=utf-8", data: JSON.stringify({ id: orderId, status: OrderStatus }), dataType: "json", success: function (t) { if ("success" == t) { return "2" == OrderStatus ? ($("#waiting_btn_" + orderId).removeAttr("class", "btn btn-warning"), $("#on_process_btn_" + orderId).attr("class", "btn btn-info"), $("#waiting_btn_" + orderId).attr("class", "btn btn-light-warning")) : ($("#on_process_btn_" + orderId).removeAttr("class", "btn btn-info"), $("#waiting_btn_" + orderId).removeAttr("class", "btn btn-warning"), $("#comlpleted_btn_" + orderId).attr("class", "btn btn-success"), $("#on_process_btn_" + orderId).attr("class", "btn btn-light-info"), $("#waiting_btn_" + orderId).attr("class", "btn btn-light-warning")), Swal.mixin({ toast: !0, position: "top-end", showConfirmButton: !1, timer: 2500, didOpen: t => { t.addEventListener("mouseenter", Swal.stopTimer), t.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "success", title: "Chuyển trạng thái đơn hàng " + orderId + ' sang "' + statusName + '" thành công' }), void UpdateModal.modal("hide") } return UpdateModal.modal("hide"), void Swal.mixin({ toast: !0, position: "top-end", showConfirmButton: !1, timer: 1500, didOpen: t => { t.addEventListener("mouseenter", Swal.stopTimer), t.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "error", title: "Đơn hàng đã hoàn thành không thể thay đổi trạng thái" }) }, error: function () { Swal.mixin({ toast: !0, position: "top", showConfirmButton: !1, timer: 1500, didOpen: t => { t.addEventListener("mouseenter", Swal.stopTimer), t.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "error", title: "Chuyển trạng thái thất bại" }) } }) }); var cancleOpen = function (t) { cancleModal.find("#cancle__id").text(t), cancleModal.modal("show"), orderId = t }; $("#cancle__submit").click(function () { $.ajax({ type: "POST", url: "/Orders/CancleOrder", contentType: "application/json; charset=utf-8", data: JSON.stringify({ id: orderId }), dataType: "json", success: function (t) { if ("success" == t) { Swal.mixin({ toast: !0, position: "top-end", showConfirmButton: !1, timer: 1500, didOpen: t => { t.addEventListener("mouseenter", Swal.stopTimer), t.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "success", title: "Hủy đơn hàng thành công" }), cancleModal.modal("hide"); let t = $("#count-trash").text(), e = Number(t) + 1; return $("#count-trash").text(e), void $("#item_" + orderId).remove() } Swal.mixin({ toast: !0, position: "top-end", showConfirmButton: !1, timer: 2e3, didOpen: t => { t.addEventListener("mouseenter", Swal.stopTimer), t.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "error", title: "Đơn hàng đã hoàn thành không thể hủy" }) }, error: function () { Swal.mixin({ toast: !0, position: "top", showConfirmButton: !1, timer: 1500, didOpen: t => { t.addEventListener("mouseenter", Swal.stopTimer), t.addEventListener("mouseleave", Swal.resumeTimer) } }).fire({ icon: "error", title: "!Lỗi" }) } }) });